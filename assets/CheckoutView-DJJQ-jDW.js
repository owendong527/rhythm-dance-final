import{a as _}from"./axios-G2rPRu76.js";import{_ as y,a as h,r as n,o as a,b as c,k as x,f as L,e as m,d as s,F as f,h as k,t as e,w as V,j as P}from"./index-4wlj--K0.js";import{c as p}from"./cartStore-KI2MBjGg.js";import{F as C}from"./FlowChart-lmk3kUL1.js";import{S as d}from"./sweetalert2.all-kcOHD6I-.js";var E={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"owen-hexschool",BASE_URL:"/rhythm-dance-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:u,VITE_PATH:b}=E,S={components:{FlowChart:C},data(){return{order:[],orderList:[],total:0,final_total:0,isLoading:!0,progress:50}},computed:{...h(p,["cart"]),...h(p,["carts"])},methods:{getOrderList(r){this.isLoading=!0,_.get(`${u}/api/${b}/order/${r}`).then(o=>{this.total=o.data.order.total,this.order=o.data.order.user,this.orderList=o.data.order.products}).catch(()=>{d.fire({icon:"error",title:"查不到此訂單，將跳轉回購物車"}),this.$router.push("/cart")}).finally(()=>{this.isLoading=!1})},addPay(r){this.isLoading=!0,_.post(`${u}/api/${b}/pay/${r}`).then(()=>{d.fire({position:"top-end",icon:"success",title:"結帳成功",showConfirmButton:!1,timer:2e3}),this.$router.push("/checksuccess"),this.progress=100}).catch(o=>{d.fire({icon:"error",title:o.response}),this.$router.push("/cart")}).finally(()=>{this.progress=100,this.isLoading=!1})},formatPrice(r){return r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},mounted(){this.getOrderList(this.$route.params.id)}},T={class:"container-fluid cart-bg pt-lg-6 pb-5 py-xl-6 px-3 px-xl-10"},B={class:"row justify-content-center pb-5","data-aos":"fade-up"},F={class:"col-md-4"},R={class:"card bg-white p-4 mb-4"},j=["src"],N={class:"w-100"},D={class:"d-flex justify-content-between"},I={class:"mb-0 fw-bold"},O={class:"mb-0"},U={class:"mb-0 fw-bold"},$=s("hr",null,null,-1),A={class:"d-flex justify-content-between mt-4"},H=s("p",{class:"mb-0 h4 fw-bold"},"總計金額",-1),q={class:"mb-0 h4 fw-bold"},M={class:"col-md-8 card"},z=s("div",{class:"card-header bg-white"},[s("h5",{class:"my-1"},"收件人資訊")],-1),G={class:"card-body"},J={class:"mb-3"},K=s("label",{for:"name",class:"form-label fw-bold"},"姓名",-1),Q={class:"fs-5"},W={class:"mb-3"},X=s("label",{for:"tel",class:"form-label fw-bold"},"電話",-1),Y={class:"fs-5"},Z={class:"mb-3"},ss=s("label",{for:"address",class:"form-label fw-bold"},"地址",-1),ts={class:"fs-5"},es={class:"mb-3"},os=s("label",{for:"email",class:"form-label fw-bold"},"E-mail",-1),rs={class:"fs-5"},is={class:"mb-3"},as=s("label",{for:"message",class:"form-label fw-bold"},"備註",-1),cs={key:0,class:"fs-5"},ls={key:1,class:"fs-5"},ns={class:"d-flex justify-content-end my-4"},ds=s("i",{class:"bi bi-chevron-double-right"},null,-1);function _s(r,o,hs,ms,t,l){const g=n("VueLoading"),v=n("FlowChart"),w=n("RouterLink");return a(),c(f,null,[t.isLoading?(a(),x(g,{key:0,active:t.isLoading,"can-cancel":!1},null,8,["active"])):L("",!0),m(v,{outProgress:t.progress},null,8,["outProgress"]),s("main",T,[s("div",B,[s("div",F,[s("div",R,[(a(!0),c(f,null,k(t.orderList,i=>(a(),c("div",{class:"d-flex mt-2",key:i.id},[s("img",{src:i.product.imagesUrl[0],alt:"product-img",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,j),s("div",N,[s("div",D,[s("p",I,e(i.product.title),1),s("p",O,"NT$"+e(l.formatPrice(i.product.price)),1)]),s("p",U,"x"+e(i.qty),1)])]))),128)),$,s("div",A,[H,s("p",q,"NT$"+e(l.formatPrice(t.total.toFixed(0))),1)])]),s("button",{type:"button",class:"btn btn-primary py-3 px-5 w-100 rounded-0",onClick:o[0]||(o[0]=i=>l.addPay(this.$route.params.id))}," 送出結帳 ")]),s("div",M,[z,s("div",G,[s("div",J,[K,s("p",Q,e(t.order.name),1)]),s("div",W,[X,s("p",Y,e(t.order.tel),1)]),s("div",Z,[ss,s("p",ts,e(t.order.address),1)]),s("div",es,[os,s("p",rs,e(t.order.email),1)]),s("div",is,[as,t.order.message?(a(),c("p",cs,e(t.order.message),1)):(a(),c("p",ls,"無填寫備註"))])])])]),s("div",ns,[m(w,{to:"/booking",class:"fs-5 text-decoration-none link-hover"},{default:V(()=>[P(" 返回前一頁 "),ds]),_:1})])])],64)}const vs=y(S,[["render",_s]]);export{vs as default};
