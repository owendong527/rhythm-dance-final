import{a as b}from"./axios-G2rPRu76.js";import{S as v}from"./sweetalert2.all-qDn9_hEP.js";import{_ as U,m as q,a as P,r as c,o as r,b as d,k as D,f as w,e as i,d as e,w as y,F as k,h as F,u as V,v as T,t as m,j as p,n as h}from"./index-d0jY9YgL.js";import{F as R}from"./FlowChart-QvEq44PZ.js";import{c as B}from"./cartStore-stkQINWY.js";var Q={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"owen-hexschool",BASE_URL:"/rhythm-dance-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:g,VITE_PATH:x}=Q,A={components:{FlowChart:R},data(){return{form:{user:{email:"",name:"",tel:"",address:"",date:""},message:""},createOrder:{},coupon_code:""}},methods:{...q(B,["addToCart","getCart","onSubmit"]),isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"電話號碼需09開頭唷"},changeQty(o,s=1){const u={product_id:o.product_id,qty:s};b.put(`${g}/api/${x}/cart/${o.id}`,{data:u}).then(()=>{this.getCart()}).catch(C=>{alert("未變更購物車數量",C.response)})},delCart(o){v.fire({title:"確定要刪除嗎？",text:"此動作將無法還原！",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"確定刪除",cancelButtonText:"取消"}).then(()=>{b.delete(`${g}/api/${x}/cart/${o}`).then(()=>{v.fire({icon:"success",title:"已成功刪除",position:"top",timer:2e3,timerProgressBar:!0,showConfirmButton:!0}),this.getCart()})})},addCouponCode(){const o=`${g}/api/${x}/coupon`,s={code:this.coupon_code};b.post(o,{data:s}).then(()=>{this.getCart()}).catch(u=>{v.fire({icon:"error",title:u.response.data.message})}).finally(()=>{this.isLoading=!1})}},computed:{...P(B,["carts","total","final_total","isLoading","cart"]),isFormIncomplete(){return!this.form.user.email||!this.form.user.name||!this.form.user.tel||!this.form.user.address},totalPriceWithDiscount(){const o=this.coupon_code?this.final_total:0;return this.total-o}},mounted(){this.getCart()}},z={class:"container my-4"},O={class:"my-5 row justify-content-center"},G={class:"col-lg-6"},H=e("h4",{class:"text-center"},"購物車資訊",-1),M=e("hr",null,null,-1),W={key:0,class:"text-center my-5"},$=e("p",{class:"fs-4 fw-bold"},[p(" 目前購物車無任何商品Q_Q"),e("br"),p("趕快來去選購吧 ")],-1),J={class:"col-md-4"},K=["src"],X={class:"col-md-8 d-flex justify-content-between align-items-center my-3 my-lg-0"},Y={class:"d-flex justify-content-between flex-lg-column"},Z={class:"mt-3"},I={class:"mt-3 mt-lg-0"},ee={class:"mt-lg-0"},te={class:"d-flex"},se={class:"input-group mb-3",style:{"max-width":"150px","max-height":"20px"}},oe=["onClick"],ne=e("i",{class:"bi bi-dash-lg"},null,-1),le=[ne],ie=["value"],ae=["onClick"],re=e("i",{class:"bi bi-plus-lg"},null,-1),ce=[re],de={class:"ms-3 d-flex flex-column justify-content-center"},me=["onClick"],ue=e("i",{class:"bi bi-trash3 fs-3"},null,-1),_e=[ue],fe=e("hr",null,null,-1),he={class:"row"},pe={class:"col-md-6 my-3"},be={class:"input-group my-auto"},ve={class:"col-md-6 my-3"},ye={key:0,class:"d-flex justify-content-between my-auto"},ge=e("span",{class:"fs-5 font-weight-bold"},"折扣：",-1),xe={class:"fs-5 text-danger"},Ce={key:1,class:"d-flex justify-content-between my-auto"},we=e("span",{class:"fs-5 fw-bold"},"折扣：",-1),ke=e("span",{class:"fs-5 text-danger"},"0",-1),Ve=[we,ke],Te={class:"d-flex justify-content-between my-auto border-dashed-top"},Be=e("p",{class:"fs-5 mb-0 fw-bold"},"應付金額：",-1),Le={class:"mb-0 fs-5 fw-bold text-secondary"},Se={class:"col-lg-6"},je=e("h4",{class:"text-center"},"訂購人資訊",-1),Ee=e("hr",null,null,-1),Ne={class:"mb-3"},Ue=e("label",{for:"email",class:"form-label"},"Email",-1),qe={class:"mb-3"},Pe=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),De={class:"mb-3"},Fe=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),Re={class:"mb-3"},Qe=e("label",{for:"address",class:"form-label"},"收件人地址",-1),Ae={class:"mb-3"},ze=e("label",{for:"message",class:"form-label"},"留言",-1),Oe={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100"},Ge=e("i",{class:"bi bi-chevron-left"},null,-1),He=["disabled"];function Me(o,s,u,C,n,a){const L=c("VueLoading"),S=c("FlowChart"),j=c("router-link"),_=c("v-field"),f=c("error-message"),E=c("RouterLink"),N=c("v-form");return r(),d(k,null,[o.isLoading?(r(),D(L,{key:0,active:o.isLoading,"can-cancel":!1},null,8,["active"])):w("",!0),i(S,{outProgress:0}),e("div",z,[e("div",O,[e("div",G,[H,M,o.carts.length<0?(r(),d("div",W,[$,i(j,{to:"/products",class:"btn btn-lg btn-success"},{default:y(()=>[p("選購商品 ")]),_:1})])):(r(!0),d(k,{key:1},F(o.carts,t=>(r(),d("div",{key:t.id,class:"row mb-3"},[e("div",J,[e("img",{src:t.product.imageUrl,alt:"product-img",class:"img-fluid object-fit-cover h-100"},null,8,K)]),e("div",X,[e("div",Y,[e("div",Z,[e("h5",null,m(t.product.title),1),e("p",I,"單價：NT$ "+m(t.product.price),1),e("p",ee,"小計：NT$ "+m(t.total),1)])]),e("div",te,[e("div",se,[t.qty>1?(r(),d("button",{key:0,class:"fs-4 btn btn-sm btn-secondary border-0",type:"button",onClick:l=>{t.qty--,a.changeQty(t,t.qty)}},le,8,oe)):w("",!0),e("input",{type:"number",class:"form-control text-center",readonly:"",value:t.qty},null,8,ie),e("button",{class:"fs-4 btn btn-sm btn-secondary border-0",type:"button",onClick:l=>{t.qty++,a.changeQty(t,t.qty)}},ce,8,ae)]),e("div",de,[e("button",{type:"button",class:"bg-white border-0",onClick:l=>a.delCart(t.id)},_e,8,me)])])])]))),128)),fe,e("div",he,[e("div",pe,[e("div",be,[V(e("input",{type:"text",class:"form-control",placeholder:"請輸入折扣碼","aria-label":"請輸入折扣碼","aria-describedby":"inputGroup-sizing-sm","onUpdate:modelValue":s[0]||(s[0]=t=>n.coupon_code=t)},null,512),[[T,n.coupon_code]]),e("button",{class:"btn btn-outline-success",type:"button",id:"inputGroup-sizing-sm2",onClick:s[1]||(s[1]=(...t)=>a.addCouponCode&&a.addCouponCode(...t))}," 套用 ")])]),e("div",ve,[n.coupon_code?(r(),d("div",ye,[ge,e("span",xe," -NT$"+m(o.$filters.currency(o.final_total)),1)])):(r(),d("div",Ce,Ve)),e("div",Te,[Be,e("p",Le,"NT$"+m(a.totalPriceWithDiscount),1)])])])]),e("div",Se,[je,Ee,i(N,{ref:"form",onSubmit:t=>"",class:"bg-light p-3 rounded"},{default:y(({errors:t})=>[e("div",Ne,[Ue,i(_,{id:"email",name:"email",type:"email",class:h(["form-control",{"is-invalid":t.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:n.form.user.email,"onUpdate:modelValue":s[2]||(s[2]=l=>n.form.user.email=l)},null,8,["class","modelValue"]),i(f,{name:"email",class:"invalid-feedback"})]),e("div",qe,[Pe,i(_,{id:"name",name:"姓名",type:"text",class:h(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:n.form.user.name,"onUpdate:modelValue":s[3]||(s[3]=l=>n.form.user.name=l)},null,8,["class","modelValue"]),i(f,{name:"姓名",class:"invalid-feedback"})]),e("div",De,[Fe,i(_,{id:"tel",name:"電話",type:"tel",class:h(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",modelValue:n.form.user.tel,"onUpdate:modelValue":s[4]||(s[4]=l=>n.form.user.tel=l),rules:a.isPhone},null,8,["class","modelValue","rules"]),i(f,{name:"電話",class:"invalid-feedback"})]),e("div",Re,[Qe,i(_,{id:"address",name:"地址",type:"text",class:h(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:n.form.user.address,"onUpdate:modelValue":s[5]||(s[5]=l=>n.form.user.address=l)},null,8,["class","modelValue"]),i(f,{name:"地址",class:"invalid-feedback"})]),e("div",Ae,[ze,V(e("textarea",{id:"message",name:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[6]||(s[6]=l=>n.form.message=l)},null,512),[[T,n.form.message]])]),e("div",Oe,[i(E,{to:"/cart",class:"text-dark mt-md-0 mt-3"},{default:y(()=>[Ge,p(" 返回上一步 ")]),_:1}),e("button",{type:"submit",class:"btn btn-primary py-3 px-5 rounded-0",onClick:s[7]||(s[7]=l=>o.onSubmit(n.form)),disabled:a.isFormIncomplete}," 送出訂單 ",8,He)])]),_:1},512)])])])],64)}const Ye=U(A,[["render",Me]]);export{Ye as default};
