import{m as V,D as L}from"./DelModal-byBxDlZF.js";import{P as D}from"./PagePagination-B5FXIw1k.js";import{a as P}from"./axios-G2rPRu76.js";import{_ as U,o as i,b as n,d as t,u as d,v as u,F as y,h as w,f as E,z as x,r as _,e as h,t as b}from"./index-4wlj--K0.js";var I={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"owen-hexschool",BASE_URL:"/rhythm-dance-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:T,VITE_PATH:C}=I,$={props:["product","isNew"],mixins:[V],data(){return{tempProduct:{},status:{}}},watch:{product(){this.tempProduct=this.product}},methods:{createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},uploadFile(){const l=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",l);const r=`${T}/api/${C}/admin/upload`;P.post(r,e).then(p=>{this.tempProduct.imageUrl=p.data.imageUrl,this.$refs.fileInput.value="",this.pushMessage({style:"success",title:"圖片上傳成功",content:p.data.message})}).catch(p=>{this.pushMessage({style:"danger",title:"圖片上傳失敗",content:p.response.data.message})})}}},R={id:"productModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},A={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},F={class:"modal-header bg-dark text-white"},B={id:"productModalLabel",class:"modal-title"},H={key:0},S={key:1},O=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),z={class:"modal-body"},j={class:"row"},Y={class:"col-sm-4"},q={class:"mb-2"},G={class:"mb-3"},J=t("label",{for:"imageUrl",class:"form-label"},"輸入【主要】圖片網址",-1),K={class:"mb-3"},Q=t("label",{for:"customFile",class:"form-label"},"或 上傳圖片",-1),W=["src"],X=t("h5",{class:"mb-3"},"多圖新增",-1),Z={key:0,class:"mb-3"},tt={class:"mb-3"},et=["for"],st=["id","onUpdate:modelValue"],ot=["src"],lt={key:0},it={key:1},nt={key:1},dt={class:"col-sm-8"},ct={class:"mb-3"},rt=t("label",{for:"title",class:"form-label"},"標題",-1),at={class:"row"},ut={class:"mb-3 col-md-6"},mt=t("label",{for:"category",class:"form-label"},"分類",-1),pt={class:"mb-3 col-md-6"},_t=t("label",{for:"price",class:"form-label"},"單位",-1),ht={class:"row"},bt={class:"mb-3 col-md-6"},ft=t("label",{for:"origin_price",class:"form-label"},"原價",-1),gt={class:"mb-3 col-md-6"},Pt=t("label",{for:"price",class:"form-label"},"售價",-1),vt=t("hr",null,null,-1),yt={class:"mb-3 col-md-6"},xt=t("label",{for:"youtubeLink",class:"form-label"},"預告片連結",-1),Ut={key:0,class:"mb-3 col-md-12"},wt=["src"],kt=t("hr",null,null,-1),Mt={class:"mb-3"},Vt=t("label",{for:"description",class:"form-label"},"產品描述",-1),Lt={class:"mb-3"},Dt=t("label",{for:"content",class:"form-label"},"說明內容",-1),Et={class:"mb-3 d-flex"},It={class:"form-check form-switch"},Tt=t("label",{class:"form-check-label",for:"is_enabled"},"啟用",-1),Ct={class:"form-check form-switch ms-4"},$t=t("label",{class:"form-check-label",for:"is_love"},"推薦",-1),Rt={class:"modal-footer"},At=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Nt(l,e,r,p,s,c){return i(),n("div",R,[t("div",A,[t("div",N,[t("div",F,[t("h5",B,[r.isNew?(i(),n("span",H,"新增產品")):(i(),n("span",S,"編輯產品"))]),O]),t("div",z,[t("div",j,[t("div",Y,[t("div",q,[t("div",G,[J,d(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=o=>s.tempProduct.imageUrl=o)},null,512),[[u,s.tempProduct.imageUrl]])]),t("div",K,[Q,t("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...o)=>c.uploadFile&&c.uploadFile(...o))},null,544)]),t("img",{class:"img-fluid",src:s.tempProduct.imageUrl,alt:""},null,8,W)]),X,Array.isArray(s.tempProduct.imagesUrl)?(i(),n("div",Z,[(i(!0),n(y,null,w(s.tempProduct.imagesUrl,(o,m)=>(i(),n("div",{class:"mb-1",key:m},[t("div",tt,[t("label",{for:`imagesUrl${m}`,class:"form-label"},"圖片網址",8,et),d(t("input",{id:`imagesUrl${m}`,type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":v=>s.tempProduct.imagesUrl[m]=v},null,8,st),[[u,s.tempProduct.imagesUrl[m]]])]),t("img",{class:"img-fluid",src:o,alt:""},null,8,ot)]))),128)),!s.tempProduct.imagesUrl.length||s.tempProduct.imagesUrl[s.tempProduct.imagesUrl.length-1]?(i(),n("div",lt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=o=>s.tempProduct.imagesUrl.push(""))}," 新增圖片 ")])):(i(),n("div",it,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[3]||(e[3]=o=>s.tempProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):(i(),n("div",nt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[4]||(e[4]=(...o)=>c.createImages&&c.createImages(...o))}," 新增圖片 ")]))]),t("div",dt,[t("div",ct,[rt,d(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=o=>s.tempProduct.title=o)},null,512),[[u,s.tempProduct.title]])]),t("div",at,[t("div",ut,[mt,d(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[6]||(e[6]=o=>s.tempProduct.category=o)},null,512),[[u,s.tempProduct.category]])]),t("div",pt,[_t,d(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[7]||(e[7]=o=>s.tempProduct.unit=o)},null,512),[[u,s.tempProduct.unit]])])]),t("div",ht,[t("div",bt,[ft,d(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[8]||(e[8]=o=>s.tempProduct.origin_price=o)},null,512),[[u,s.tempProduct.origin_price]])]),t("div",gt,[Pt,d(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[9]||(e[9]=o=>s.tempProduct.price=o)},null,512),[[u,s.tempProduct.price]])])]),vt,t("div",yt,[xt,d(t("input",{id:"youtubeLink",type:"text",class:"form-control",placeholder:"請輸入youtube連結","onUpdate:modelValue":e[10]||(e[10]=o=>s.tempProduct.youtubeLink=o)},null,512),[[u,s.tempProduct.youtubeLink]])]),typeof s.tempProduct.youtubeLink=="string"?(i(),n("div",Ut,[t("iframe",{width:"100%",height:"400",src:`${s.tempProduct.youtubeLink}?rel=0`,title:"YouTube video player",frameborder:"0",allow:`accelerometer; autoplay;
                clipboard-write; encrypted-media;
                gyroscope; picture-in-picture; web-share`,allowfullscreen:""},null,8,wt)])):E("",!0),kt,t("div",Mt,[Vt,d(t("textarea",{id:"description",type:"text",class:"form-control",rows:"5",placeholder:"請輸入產品描述","onUpdate:modelValue":e[11]||(e[11]=o=>s.tempProduct.description=o)},null,512),[[u,s.tempProduct.description]])]),t("div",Lt,[Dt,d(t("textarea",{id:"content",type:"text",class:"form-control",rows:"5",placeholder:"請輸入說明內容","onUpdate:modelValue":e[12]||(e[12]=o=>s.tempProduct.content=o)},null,512),[[u,s.tempProduct.content]])]),t("div",Et,[t("div",It,[d(t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_enabled","true-value":1,"false-value":0,"onUpdate:modelValue":e[13]||(e[13]=o=>s.tempProduct.is_enabled=o)},null,512),[[x,s.tempProduct.is_enabled]]),Tt]),t("div",Ct,[d(t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_love","true-value":1,"false-value":0,"onUpdate:modelValue":e[14]||(e[14]=o=>s.tempProduct.is_love=o)},null,512),[[x,s.tempProduct.is_love]]),$t])])])])]),t("div",Rt,[At,t("button",{type:"button",class:"btn btn-primary",onClick:e[15]||(e[15]=o=>l.$emit("update-product",s.tempProduct))}," 確認 ")])])])],512)}const Ft=U($,[["render",Nt]]);var Bt={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"owen-hexschool",BASE_URL:"/rhythm-dance-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:f,VITE_PATH:g}=Bt,Ht={data(){return{products:[],isNew:!1,tempProduct:{imagesUrl:[]},pagination:{},isLoading:!1,currentPage:1}},components:{ProductModal:Ft,DelModal:L,Pagination:D},methods:{getData(l=1){this.currentPage=l;const e=`${f}/api/${g}/admin/products?page=${l}`;this.isLoading=!0,P.get(e).then(r=>{this.products=r.data.products,this.pagination=r.data.pagination,this.isLoading=!1}).catch(()=>{this.isLoading=!1})},openModal(l,e){l==="add"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.productModal.openModal()):l==="edit"?(this.tempProduct={...e},this.isNew=!1,this.$refs.productModal.openModal()):l==="del"&&(this.tempProduct={...e},this.$refs.delModal.openModal())},updateData(l){this.isLoading=!0,this.tempProduct=l;let e=`${f}/api/${g}/admin/product`,r="post";this.isNew||(e=`${f}/api/${g}/admin/product/${this.tempProduct.id}`,r="put"),P[r](e,{data:this.tempProduct}).then(()=>{this.isLoading=!1,this.$refs.productModal.hideModal(),this.getData(this.currentPage)}).catch(()=>{this.isLoading=!1})},removeData(){const l=`${f}/api/${g}/admin/product/${this.tempProduct.id}`;this.isLoading=!0,P.delete(l).then(()=>{this.isLoading=!1,this.$refs.delModal.hideModal(),this.getData(this.currentPage)}).catch(()=>{this.isLoading=!1})}},created(){this.getData()}},St={class:"container"},Ot={class:"d-flex justify-content-between align-items-center"},zt=t("h2",{class:"my-4 fw-bold"},"產品明細",-1),jt={class:"table-responsive"},Yt={class:"table align-middle table-bordered"},qt=t("thead",{class:"fs-5"},[t("tr",{class:"table-active"},[t("th",{width:"125",class:"text-center d-none d-sm-table-cell"},"產品縮圖"),t("th",{class:"text-center"},"產品名稱"),t("th",{width:"120",class:"text-center d-none d-sm-table-cell"},"分類"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100",class:"text-center"},"啟用"),t("th",{width:"140",class:"text-center"},"編輯")])],-1),Gt={class:"fs-5"},Jt={class:"d-none d-sm-table-cell"},Kt=["src"],Qt={class:"text-center d-none d-sm-table-cell"},Wt={class:"text-end"},Xt={class:"text-end"},Zt={class:"text-center"},te={key:0,class:"text-success"},ee=t("i",{class:"bi bi-check-circle-fill h5"},null,-1),se=[ee],oe={key:1,class:"text-danger"},le=t("i",{class:"bi bi-x-circle-fill h5"},null,-1),ie=[le],ne={class:"text-center"},de={class:"btn-group flex-sm-row flex-column"},ce=["onClick"],re=["onClick"];function ae(l,e,r,p,s,c){const o=_("VueLoading"),m=_("Pagination"),v=_("ProductModal"),k=_("DelModal");return i(),n(y,null,[h(o,{active:s.isLoading,"z-index":1060},null,8,["active"]),t("div",St,[t("div",Ot,[zt,t("div",null,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=a=>c.openModal("add"))}," 建立新的產品 ")])]),t("div",jt,[t("table",Yt,[qt,t("tbody",Gt,[(i(!0),n(y,null,w(s.products,a=>(i(),n("tr",{key:a.id},[t("td",Jt,[t("img",{class:"img-fluid",src:a.imageUrl,alt:"",width:"100"},null,8,Kt)]),t("td",null,b(a.title),1),t("td",Qt,b(a.category),1),t("td",Wt,b(a.origin_price),1),t("td",Xt,b(a.price),1),t("td",Zt,[a.is_enabled?(i(),n("span",te,se)):(i(),n("span",oe,ie))]),t("td",ne,[t("div",de,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm mb-sm-0 mb-2",onClick:M=>c.openModal("edit",a)}," 編輯 ",8,ce),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:M=>c.openModal("del",a)}," 刪除 ",8,re)])])]))),128))])])]),h(m,{pages:s.pagination,onEmitPages:c.getData},null,8,["pages","onEmitPages"]),h(v,{product:s.tempProduct,"is-new":s.isNew,onUpdateProduct:c.updateData,ref:"productModal"},null,8,["product","is-new","onUpdateProduct"]),h(k,{item:s.tempProduct,onDelItem:c.removeData,ref:"delModal"},null,8,["item","onDelItem"])])],64)}const he=U(Ht,[["render",ae]]);export{he as default};
